version: "3.7"
services:
  nodered:
    image: nodered/node-red:latest
    restart: unless-stopped
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
        max_attempts: 5
      labels:
        - "traefik.enable=true"
        - "traefik.docker.network=building-automation_default"
        - "traefik.port=80"
        - "traefik.http.services.whoami.loadbalancer.server.port=1880"
        - "traefik.http.routers.whoami.rule=Host(`nodered.apps.hskrk.pl`)"
        - "traefik.http.routers.whoami.middlewares=authentik@docker"
    volumes:
      - nodered_data:/data

volumes:
    nodered_data:
